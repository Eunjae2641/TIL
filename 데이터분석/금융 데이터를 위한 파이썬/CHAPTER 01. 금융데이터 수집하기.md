#### CHAPTER 01.금융 데이터 수집하기

일반인이 인터넷을 통해 돈을 지급하지 않고 수집하는 방법으로 **파이썬 패키지, 오픈 API, 웹 크롤링**이 있다.

**파이썬 패키지**의 경우 수집 대상 즉, 범위가 좁은 대신 활용 난이도가 쉽다.
가장 쉽게 데이터를 수집하는 방법으로 보통 오픈 API로 제공되는 데이터를 쉽게 재구성한 패키지들이다. 
가장 대표적인 패키지로는 pandas-datareader가 있다.

**오픈 API**의 경우 범위도 중간, 활용 난이도도 중간이다.
금융 데이터를 수집하기 위해 가장 적절한 방법이지만 모든 데이터가 오픈API로 제공되지 않는다.
API란, Application Programming Interface의 약자로 해당 기능을 이용하여 다른 프로그램을 만들 수 있는 수준의 인터페이스를 제공하는 것을 말한다.
최근, 금융결제원을 통해 금융 관련 API가 많이 개방되고 있다. 데이터를 제공하는 것도 API로 구현된 곳이 많다. 
공공기관에서도 오픈 API를 통해 많은 데이터를 공개하고 있다. 공공 데이터 포털(www.data.go.kr)에 가면 개방된 데이터를 한 번에 볼 수 있다.

**웹 크롤링**의 경우 범위가 넓은 대신 활용 난이도가 어렵다.
웹에 있는 모든 데이터를 내 PC로 저장할 수 있다. 그래서 수집할 수 있는 범위가 가장 넓지만, HTML, CSS, 자바스크립트 등 웹에서 사용되는 기술에 대해 일부 알아야 한다. 웹 크롤링 방법도 여러 가지가 있다.
가장 많이 사용하는 방법으로는 **urllib 패키지 이용, 셀레늄(selenium) 이용, scrapy 패키지 이용**이 있습니다. 

**urllib 패키지 이용**은 범위가 좁고 활용 난이도가 쉽다.
파이썬으로 웹 크롤링할 때 가장 먼저 하는 방법이 urllib 패키지를 이용하는 것이지만, 동적으로 변하는 페이지를 크롤링하거나 자동화하기에 어려움이 있다.

**셀레늄(selenium) 패키지**는 웹 테스트 자동화를 위한 도구로, 파이썬 코드로 웹 브라우저를 조정할 수 있고 웹에서 할 수 있는 거의 모든 동작을 할 수 있어 매우 유용하다. 범위가 넓지만 활용 난이도가 어렵다.

**scrapy 패키지**는 크롤링을 위한 단계들이 미리 구조화되어 있어 많은 웹 페이지를 자주 수집할 떄 유용한 패키지이다. 범위도 중간, 활용 난이도도 중간.

### 1.1 파이썬 패키지를 이용하여 데이터 수집하기
pandas-datareader로 금융 데이터를 제공하는 여러 가지 사이트의 정보를 쉽게 수집한다. 또한, 국내 주식 데이터를 수집하는 finance-datareader가 있다.

## 1.1.1 pandas-datareader 이용하기
수집가능한 주요 데이터는 **주가 데이터, 주가 지수 데이터, 환율 데이터, 원자재 가격 데이터, 그 외 경제 지표 데이터**가 있다.

# 주가 데이터
pandas-datareader로 주가 데이터를 수집하는 방법으로는 **야후**와 **구글 파이낸스**가 대표적이다. 하지만 곧 없어질 에정이기에 이 책에서는 **tiingo**를 사용하여 해외 주가 데이터만 수집했다. 국내 주가 데이터는 **FinanceDataReader**를 이용해 받는다. 
**tiingo**를 이용하려면 API KEY를 발급 받아야한다. 구글 종목 코드를 입력해서 주가 데이터를 받아 보고, head 함수를 통해서 확인하는 코드다.
원하는 주식의 종목 코드를 알고 싶다면, tiingo나 야후 파이낸스에서 주식명으로 검색.
코드는 code 폴더의 financedata.ipynb를 참고.

# 주가 지수 데이터
코스피나 나스닥 같은 주가 지수 정보는 **Stooq**라는 곳에서 수집 가능하다. Stooq에 접속해서 원하는 주가 지수를 입력하면 코드 정보를 알 수 있다.
KOSPI를 검색하여 코스피 검색 지수 코드를 확인하고, 지수 변화를 그래프로 그리는 코드다.
코드는 code 폴더의 Stooq.ipynb를 참고.

# 환율 데이터
**Alpha Vantage**에서 환율 데이터에 대해 무료로 API KEY를 발급받아 수집할 수 있다. DATAREADER 함수를 이용해 실시간 환율을 받을 수 있다.
관련 코드는 code 폴더의 USDKRW.ipynb를 참고.
pandas-datareader 패키지는 실시간 환율 데이터만 수집할 수 있다. 기간별 환율 데이터를 수집하고 싶다면, 직접 수집해야한다.
API로 데이터를 수집하기 위해서는 urllib 패키지를 이용하여 url에 필요한 파라미터를 입력한 후 전송하면 그에 맞는 데이터가 회신된다. 
일별 환율 데이터를 수집하기 위해서 아래와 같이 url을 구성. 주별,월별 단위의 데이터도 수집이 가능하다.

API를 이용해서 데이터를 수집하는 방법은 1.2 OPEN API를 이용하여 데이터 수집하기 참조.

```<참고자료> 금융 데이터를 위한 파이썬(작가 테리엇)```